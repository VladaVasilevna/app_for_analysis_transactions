from typing import Any, Dict, List
from unittest import mock

import pandas as pd
import pytest


@pytest.fixture
def user_settings() -> Dict[str, Any]:
    """Фикстура для загрузки пользовательских настроек из JSON файла."""
    return {"user_currencies": ["USD", "EUR"], "user_stocks": ["AAPL", "GOOGL"]}


@pytest.fixture
def mock_excel_data() -> pd.DataFrame:
    """Фикстура для создания тестовых данных Excel."""
    data: Dict[str, Any] = {
        "Дата операции": pd.to_datetime(["2024-01-01", "2024-01-15", "2024-01-20"]),
        "Номер карты": ["1234", "5678", "1234"],
        "Сумма операции": [-100.0, -150.0, -200.0],
        "Сумма платежа": [-100.0, -150.0, -200.0],
        "Категория": ["Еда", "Транспорт", "Развлечения"],
        "Описание": ["Обед", "Такси", "Кино"],
    }
    return pd.DataFrame(data)


@pytest.fixture
def mock_function() -> mock.Mock:
    """Фикстура для создания мок-функции."""
    return mock.Mock(return_value={"data": "test report"})


@pytest.fixture
def transactions() -> List[Dict[str, Any]]:
    """Фикстура для генерации тестовых данных о транзакциях."""
    return [
        {"Дата операции": "15.01.2023 14:00:00", "Сумма операции": 123.45},
        {"Дата операции": "20.01.2023 10:30:00", "Сумма операции": 67.89},
        {"Дата операции": "25.01.2023 16:15:00", "Сумма операции": 200.00},
        {"Дата операции": "05.02.2023 09:00:00", "Сумма операции": 150.00},
        {"Дата операции": "15.02.2023 12:00:00", "Сумма операции": 75.50},
        {"Дата операции": "01.03.2023 18:30:00", "Сумма операции": 90.00},
    ]
